<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.geometry.Insets?>

<StackPane xmlns:fx="http://javafx.com/fxml"
           fx:controller="esprit.tn.souha_pi.controllers.loan.RequestLoanController">

    <VBox alignment="CENTER" spacing="20">

        <!-- CARD -->
        <VBox spacing="16" maxWidth="420"
              style="-fx-background-color:white;
                     -fx-padding:25;
                     -fx-background-radius:16;
                     -fx-border-radius:16;
                     -fx-border-color:#e0e0e0;
                     -fx-effect:dropshadow(gaussian, rgba(0,0,0,0.12), 15,0,0,4);">

            <Label text="Request a Loan"
                   style="-fx-font-size:22px; -fx-font-weight:bold;"/>

            <Separator/>

            <!-- SELECT LENDER -->
            <VBox spacing="6">
                <Label text="Choose a lender"/>
                <ComboBox fx:id="userCombo" prefHeight="38" promptText="Select a user"/>
            </VBox>

            <!-- AMOUNT -->
            <VBox spacing="6">
                <Label text="Amount (TND)"/>
                <TextField fx:id="amountField" prefHeight="38" promptText="Ex: 150"/>
            </VBox>

            <!-- MESSAGE -->
            <VBox spacing="6">
                <Label text="Message (optional)"/>
                <TextArea fx:id="messageField"
                          prefHeight="90"
                          promptText="Explain why you need the loan..."/>
            </VBox>

            <!-- IA ANALYSIS BOX - Dans la carte -->
            <VBox fx:id="iaAnalysisBox" spacing="10"
                  style="-fx-background-color: #e8f5e9; -fx-padding: 15; -fx-background-radius: 10; -fx-border-color: #c8e6c9; -fx-border-radius: 10;"
                  visible="false" managed="false">
                <Label text="ðŸ¤– ANALYSE IA" style="-fx-font-weight: bold; -fx-text-fill: #2e7d32; -fx-font-size: 14px;"/>
                <HBox spacing="10" alignment="CENTER_LEFT">
                    <Label fx:id="iaProbabilityLabel" text="ProbabilitÃ©: -" style="-fx-font-weight: bold;"/>
                    <ProgressBar fx:id="iaProbabilityBar" prefWidth="150" progress="0"/>
                </HBox>
                <Label fx:id="iaRecommendationLabel" text="Niveau: -"/>
                <Label fx:id="iaSuggestionLabel" text="ðŸ’¡ " wrapText="true"/>
                <CheckBox fx:id="iaOptimizeCheckbox" text="Optimiser avec IA" style="-fx-text-fill: #2e7d32;"/>
            </VBox>

            <!-- BUTTON -->
            <Button text="ðŸ¤ Send Loan Request"
                    prefHeight="42"
                    onAction="#sendRequest"
                    style="-fx-background-color:#2ecc71;
                           -fx-text-fill:white;
                           -fx-font-weight:bold;
                           -fx-font-size:14px;"/>

            <Label fx:id="statusLabel"
                   style="-fx-text-fill:#2c3e50; -fx-font-size:13px;"/>

        </VBox>

        <!-- IA INSIGHTS CONTAINER - En bas avec marge -->
        <VBox fx:id="iaInsightsContainer" spacing="10"
              style="-fx-background-color: #f3e5f5; -fx-padding: 15; -fx-background-radius: 10; -fx-border-color: #ce93d8; -fx-border-radius: 10;"
              maxWidth="420">
            <Label text="ðŸ“Š STATISTIQUES IA" style="-fx-font-weight: bold; -fx-text-fill: #8e24aa; -fx-font-size: 14px;"/>
            <Label fx:id="iaSummaryLabel" text="Analyse globale en cours..." style="-fx-text-fill: #555;"/>
        </VBox>

    </VBox>

</StackPane>