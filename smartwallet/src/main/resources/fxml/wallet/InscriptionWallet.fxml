<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.Button?>
<?import javafx.scene.control.CheckBox?>
<?import javafx.scene.control.ComboBox?>
<?import javafx.scene.control.DatePicker?>
<?import javafx.scene.control.Label?>
<?import javafx.scene.control.PasswordField?>
<?import javafx.scene.control.ProgressBar?>
<?import javafx.scene.control.RadioButton?>
<?import javafx.scene.control.ScrollPane?>
<?import javafx.scene.control.Separator?>
<?import javafx.scene.control.Slider?>
<?import javafx.scene.control.TextField?>
<?import javafx.scene.layout.GridPane?>
<?import javafx.scene.layout.HBox?>
<?import javafx.scene.layout.StackPane?>
<?import javafx.scene.layout.VBox?>

<StackPane xmlns:fx="http://javafx.com/fxml"
           fx:controller="esprit.tn.souha_pi.controllers.wallet.InscriptionWalletController"
           style="-fx-background-color: #f5f7fb;">

    <VBox alignment="CENTER" spacing="20" maxWidth="750">
        <padding>
            <Insets top="30" bottom="30" left="30" right="30"/>
        </padding>

        <!-- Carte principale -->
        <VBox spacing="25" maxWidth="700"
              style="-fx-background-color:white;
                     -fx-padding:35;
                     -fx-background-radius:30;
                     -fx-border-radius:30;
                     -fx-border-color:#e5e7eb;
                     -fx-border-width:1;
                     -fx-effect:dropshadow(gaussian, rgba(0,0,0,0.1), 20,0,0,5);">

            <!-- En-tÃªte avec gradient -->
            <HBox alignment="CENTER" spacing="15">
                <Label text="ðŸ’°" style="-fx-font-size:48px; -fx-text-fill: #4f46e5;"/>
                <Label text="ACTIVER MON WALLET"
                       style="-fx-font-size:26px; -fx-font-weight:bold; -fx-text-fill: #4f46e5;"/>
            </HBox>

            <Separator style="-fx-background-color: #e5e7eb;"/>

            <!-- Barre de progression -->
            <VBox spacing="10">
                <HBox alignment="CENTER" spacing="15">
                    <Label text="Ã‰tape" style="-fx-font-size:14px; -fx-text-fill:#64748b;"/>
                    <Label fx:id="etapeLabel" text="1/7"
                           style="-fx-font-size:16px; -fx-font-weight:bold; -fx-text-fill:#4f46e5;
                                  -fx-background-color:#e0e7ff; -fx-background-radius:20; -fx-padding:5 15;"/>
                    <ProgressBar fx:id="progressBar" prefWidth="350" progress="0.142"
                                 style="-fx-accent: #4f46e5;"/>
                </HBox>
                <Label text="CrÃ©ez votre wallet en 7 Ã©tapes simples"
                       style="-fx-font-size:13px; -fx-text-fill:#64748b; -fx-alignment:center;"/>
            </VBox>

            <!-- ================= Ã‰TAPE 1 : INFOS PERSONNELLES ================= -->
            <VBox fx:id="etape1" spacing="20" visible="true" managed="true">

                <Label text="ðŸ“‹ Ã‰TAPE 1 : INFORMATIONS PERSONNELLES"
                       style="-fx-font-size:18px; -fx-font-weight:bold; -fx-text-fill:#4f46e5;"/>

                <GridPane hgap="15" vgap="12">
                    <columnConstraints>
                        <ColumnConstraints percentWidth="30"/>
                        <ColumnConstraints percentWidth="70"/>
                    </columnConstraints>

                    <Label text="Nom complet :" GridPane.rowIndex="0" GridPane.columnIndex="0"
                           style="-fx-font-weight:600; -fx-text-fill:#374151;"/>
                    <TextField fx:id="nomField" promptText="Jean Dupont"
                               GridPane.rowIndex="0" GridPane.columnIndex="1"
                               style="-fx-background-color: white; -fx-border-color: #d1d5db; -fx-border-radius: 10; -fx-background-radius: 10; -fx-padding: 10 15;"/>

                    <Label text="Date naissance :" GridPane.rowIndex="1" GridPane.columnIndex="0"
                           style="-fx-font-weight:600; -fx-text-fill:#374151;"/>
                    <DatePicker fx:id="dateNaissancePicker" promptText="jj/mm/aaaa"
                                GridPane.rowIndex="1" GridPane.columnIndex="1"
                                style="-fx-background-color: white; -fx-border-color: #d1d5db; -fx-border-radius: 10; -fx-background-radius: 10; -fx-pref-height: 40;"/>

                    <Label text="NationalitÃ© :" GridPane.rowIndex="2" GridPane.columnIndex="0"
                           style="-fx-font-weight:600; -fx-text-fill:#374151;"/>
                    <ComboBox fx:id="nationaliteCombo" promptText="SÃ©lectionnez"
                              GridPane.rowIndex="2" GridPane.columnIndex="1"
                              style="-fx-background-color: white; -fx-border-color: #d1d5db; -fx-border-radius: 10; -fx-background-radius: 10; -fx-pref-height: 40;"/>

                    <Label text="Pays rÃ©sidence :" GridPane.rowIndex="3" GridPane.columnIndex="0"
                           style="-fx-font-weight:600; -fx-text-fill:#374151;"/>
                    <ComboBox fx:id="paysCombo" promptText="SÃ©lectionnez"
                              GridPane.rowIndex="3" GridPane.columnIndex="1"
                              style="-fx-background-color: white; -fx-border-color: #d1d5db; -fx-border-radius: 10; -fx-background-radius: 10; -fx-pref-height: 40;"/>

                    <Label text="Email :" GridPane.rowIndex="4" GridPane.columnIndex="0"
                           style="-fx-font-weight:600; -fx-text-fill:#374151;"/>
                    <TextField fx:id="emailField" promptText="exemple@email.com"
                               GridPane.rowIndex="4" GridPane.columnIndex="1"
                               style="-fx-background-color: white; -fx-border-color: #d1d5db; -fx-border-radius: 10; -fx-background-radius: 10; -fx-padding: 10 15;"/>

                    <Label text="TÃ©lÃ©phone :" GridPane.rowIndex="5" GridPane.columnIndex="0"
                           style="-fx-font-weight:600; -fx-text-fill:#374151;"/>
                    <TextField fx:id="telephoneField" promptText="+216 XX XXX XXX"
                               GridPane.rowIndex="5" GridPane.columnIndex="1"
                               style="-fx-background-color: white; -fx-border-color: #d1d5db; -fx-border-radius: 10; -fx-background-radius: 10; -fx-padding: 10 15;"/>

                    <Label text="Code admin :" GridPane.rowIndex="6" GridPane.columnIndex="0"
                           style="-fx-font-weight:600; -fx-text-fill:#374151;"/>
                    <PasswordField fx:id="adminCodeField" promptText="Laisser vide"
                                   GridPane.rowIndex="6" GridPane.columnIndex="1"
                                   style="-fx-background-color: white; -fx-border-color: #d1d5db; -fx-border-radius: 10; -fx-background-radius: 10; -fx-padding: 10 15;"/>
                </GridPane>

                <Label fx:id="erreurEtape1" text="" style="-fx-text-fill:#ef4444; -fx-font-size:13px;"/>

                <HBox alignment="CENTER_RIGHT">
                    <Button text="Ã‰tape suivante â†’" onAction="#allerEtape2"
                            style="-fx-background-color:#4f46e5; -fx-text-fill:white; -fx-font-weight:bold;
                                   -fx-background-radius:25; -fx-cursor:hand; -fx-padding:12 30; -fx-font-size:14px;
                                   -fx-effect:dropshadow(two-pass-box, rgba(79,70,229,0.3), 8,0,0,2);"/>
                </HBox>
            </VBox>

            <!-- ================= Ã‰TAPE 2 : DOCUMENTS KYC ================= -->
            <VBox fx:id="etape2" spacing="20" visible="false" managed="false">

                <Label text="ðŸ†” Ã‰TAPE 2 : VÃ‰RIFICATION D'IDENTITÃ‰"
                       style="-fx-font-size:18px; -fx-font-weight:bold; -fx-text-fill:#4f46e5;"/>

                <!-- PiÃ¨ce d'identitÃ© -->
                <VBox spacing="8" style="-fx-background-color:#f8fafc; -fx-padding:15; -fx-background-radius:12;">
                    <HBox spacing="10" alignment="CENTER_LEFT">
                        <Label text="ðŸ“„" style="-fx-font-size:20px;"/>
                        <Label text="PIÃˆCE D'IDENTITÃ‰" style="-fx-font-weight:bold; -fx-text-fill:#334155;"/>
                    </HBox>
                    <Label text="Carte nationale ou passeport" style="-fx-text-fill:#64748b; -fx-font-size:13px;"/>
                    <HBox alignment="CENTER_LEFT" spacing="15">
                        <Button text="+ Ajouter" onAction="#ajouterPieceIdentite"
                                style="-fx-background-color:#e2e8f0; -fx-text-fill:#1e293b;
                                       -fx-font-weight:bold; -fx-background-radius:6; -fx-cursor:hand;"/>
                        <Label fx:id="pieceIdentiteNom" text="Aucun fichier"
                               style="-fx-text-fill:#94a3b8; -fx-font-size:12px;"/>
                    </HBox>
                </VBox>

                <!-- Selfie -->
                <VBox spacing="8" style="-fx-background-color:#f8fafc; -fx-padding:15; -fx-background-radius:12;">
                    <HBox spacing="10" alignment="CENTER_LEFT">
                        <Label text="ðŸ¤³" style="-fx-font-size:20px;"/>
                        <Label text="SELFIE" style="-fx-font-weight:bold; -fx-text-fill:#334155;"/>
                    </HBox>
                    <Label text="Photo avec votre piÃ¨ce d'identitÃ©" style="-fx-text-fill:#64748b; -fx-font-size:13px;"/>
                    <HBox alignment="CENTER_LEFT" spacing="15">
                        <Button text="ðŸ“¸ Prendre" onAction="#prendreSelfie"
                                style="-fx-background-color:#e2e8f0; -fx-text-fill:#1e293b;
                                       -fx-font-weight:bold; -fx-background-radius:6; -fx-cursor:hand;"/>
                        <Label fx:id="selfieNom" text="Pas de photo"
                               style="-fx-text-fill:#94a3b8; -fx-font-size:12px;"/>
                    </HBox>
                </VBox>

                <!-- Justificatif de domicile -->
                <VBox spacing="8" style="-fx-background-color:#f8fafc; -fx-padding:15; -fx-background-radius:12;">
                    <HBox spacing="10" alignment="CENTER_LEFT">
                        <Label text="ðŸ " style="-fx-font-size:20px;"/>
                        <Label text="JUSTIFICATIF DE DOMICILE" style="-fx-font-weight:bold; -fx-text-fill:#334155;"/>
                    </HBox>
                    <Label text="Facture de moins de 3 mois" style="-fx-text-fill:#64748b; -fx-font-size:13px;"/>
                    <HBox alignment="CENTER_LEFT" spacing="15">
                        <Button text="+ Ajouter" onAction="#ajouterJustificatif"
                                style="-fx-background-color:#e2e8f0; -fx-text-fill:#1e293b;
                                       -fx-font-weight:bold; -fx-background-radius:6; -fx-cursor:hand;"/>
                        <Label fx:id="justificatifNom" text="Aucun fichier"
                               style="-fx-text-fill:#94a3b8; -fx-font-size:12px;"/>
                    </HBox>
                </VBox>

                <HBox spacing="15" alignment="CENTER_RIGHT">
                    <Button text="â† Retour" onAction="#allerEtape1"
                            style="-fx-background-color:#64748b; -fx-text-fill:white; -fx-font-weight:bold;
                                   -fx-background-radius:25; -fx-cursor:hand; -fx-padding:10 20; -fx-font-size:14px;"/>
                    <Button text="Ã‰tape suivante â†’" onAction="#allerEtape3"
                            style="-fx-background-color:#4f46e5; -fx-text-fill:white; -fx-font-weight:bold;
                                   -fx-background-radius:25; -fx-cursor:hand; -fx-padding:12 30; -fx-font-size:14px;
                                   -fx-effect:dropshadow(two-pass-box, rgba(79,70,229,0.3), 8,0,0,2);"/>
                </HBox>
            </VBox>

            <!-- ================= Ã‰TAPE 3 : SÃ‰CURITÃ‰ ================= -->
            <VBox fx:id="etape3" spacing="20" visible="false" managed="false">

                <Label text="ðŸ” Ã‰TAPE 3 : SÃ‰CURITÃ‰ DU COMPTE"
                       style="-fx-font-size:18px; -fx-font-weight:bold; -fx-text-fill:#4f46e5;"/>

                <GridPane hgap="15" vgap="12">
                    <columnConstraints>
                        <ColumnConstraints percentWidth="30"/>
                        <ColumnConstraints percentWidth="70"/>
                    </columnConstraints>

                    <Label text="Code PIN :" GridPane.rowIndex="0" GridPane.columnIndex="0"
                           style="-fx-font-weight:600; -fx-text-fill:#374151;"/>
                    <PasswordField fx:id="pinField" promptText="4 Ã  6 chiffres"
                                   GridPane.rowIndex="0" GridPane.columnIndex="1"
                                   style="-fx-background-color: white; -fx-border-color: #d1d5db; -fx-border-radius: 10; -fx-background-radius: 10; -fx-padding: 10 15;"/>

                    <Label text="Mot de passe :" GridPane.rowIndex="1" GridPane.columnIndex="0"
                           style="-fx-font-weight:600; -fx-text-fill:#374151;"/>
                    <PasswordField fx:id="passwordField" promptText="Min 8 caractÃ¨res"
                                   GridPane.rowIndex="1" GridPane.columnIndex="1"
                                   style="-fx-background-color: white; -fx-border-color: #d1d5db; -fx-border-radius: 10; -fx-background-radius: 10; -fx-padding: 10 15;"/>

                    <Label text="Confirmer :" GridPane.rowIndex="2" GridPane.columnIndex="0"
                           style="-fx-font-weight:600; -fx-text-fill:#374151;"/>
                    <PasswordField fx:id="confirmPasswordField" promptText="Retapez le mot de passe"
                                   GridPane.rowIndex="2" GridPane.columnIndex="1"
                                   style="-fx-background-color: white; -fx-border-color: #d1d5db; -fx-border-radius: 10; -fx-background-radius: 10; -fx-padding: 10 15;"/>

                    <Label text="Question secrÃ¨te :" GridPane.rowIndex="3" GridPane.columnIndex="0"
                           style="-fx-font-weight:600; -fx-text-fill:#374151;"/>
                    <ComboBox fx:id="questionCombo" promptText="Choisissez"
                              GridPane.rowIndex="3" GridPane.columnIndex="1"
                              style="-fx-background-color: white; -fx-border-color: #d1d5db; -fx-border-radius: 10; -fx-background-radius: 10; -fx-pref-height: 40;"/>

                    <Label text="RÃ©ponse :" GridPane.rowIndex="4" GridPane.columnIndex="0"
                           style="-fx-font-weight:600; -fx-text-fill:#374151;"/>
                    <TextField fx:id="reponseField" promptText="Votre rÃ©ponse"
                               GridPane.rowIndex="4" GridPane.columnIndex="1"
                               style="-fx-background-color: white; -fx-border-color: #d1d5db; -fx-border-radius: 10; -fx-background-radius: 10; -fx-padding: 10 15;"/>
                </GridPane>

                <CheckBox fx:id="twoFactorCheck" text="Activer la double authentification (recommandÃ©)"
                          style="-fx-text-fill:#374151; -fx-font-size:14px;"/>

                <HBox spacing="15" alignment="CENTER_RIGHT">
                    <Button text="â† Retour" onAction="#allerEtape2"
                            style="-fx-background-color:#64748b; -fx-text-fill:white; -fx-font-weight:bold;
                                   -fx-background-radius:25; -fx-cursor:hand; -fx-padding:10 20; -fx-font-size:14px;"/>
                    <Button text="Ã‰tape suivante â†’" onAction="#allerEtape4"
                            style="-fx-background-color:#4f46e5; -fx-text-fill:white; -fx-font-weight:bold;
                                   -fx-background-radius:25; -fx-cursor:hand; -fx-padding:12 30; -fx-font-size:14px;
                                   -fx-effect:dropshadow(two-pass-box, rgba(79,70,229,0.3), 8,0,0,2);"/>
                </HBox>
            </VBox>

            <!-- ================= Ã‰TAPE 4 : TYPE DE COMPTE ================= -->
            <VBox fx:id="etape4" spacing="20" visible="false" managed="false">

                <Label text="ðŸ’³ Ã‰TAPE 4 : CHOISISSEZ VOTRE FORMULE"
                       style="-fx-font-size:18px; -fx-font-weight:bold; -fx-text-fill:#4f46e5;"/>

                <ScrollPane fitToWidth="true" prefHeight="200"
                            style="-fx-background: transparent; -fx-background-color: transparent; -fx-border-color: transparent;">
                    <VBox spacing="15">
                        <VBox spacing="5" style="-fx-background-color:#f8fafc; -fx-padding:12; -fx-background-radius:10;">
                            <RadioButton fx:id="standardRadio" text="WALLET STANDARD - Gratuit"
                                         style="-fx-font-weight:bold; -fx-text-fill:#1e293b;"/>
                            <Label text="âœ“ Envoi et rÃ©ception d'argent" style="-fx-padding:0 0 0 25; -fx-text-fill:#475569;"/>
                        </VBox>

                        <VBox spacing="5" style="-fx-background-color:#f8fafc; -fx-padding:12; -fx-background-radius:10;">
                            <RadioButton fx:id="virtuelleRadio" text="CARTE VIRTUELLE - 5 TND"
                                         style="-fx-font-weight:bold; -fx-text-fill:#1e293b;"/>
                            <Label text="âœ“ Carte pour paiements internet" style="-fx-padding:0 0 0 25; -fx-text-fill:#475569;"/>
                            <Label text="âœ“ Plafond : 2000 TND/mois" style="-fx-padding:0 0 0 25; -fx-text-fill:#475569;"/>
                        </VBox>

                        <VBox spacing="5" style="-fx-background-color:#f8fafc; -fx-padding:12; -fx-background-radius:10;">
                            <RadioButton fx:id="physiqueRadio" text="CARTE PHYSIQUE - 10 TND"
                                         style="-fx-font-weight:bold; -fx-text-fill:#1e293b;"/>
                            <Label text="âœ“ Carte livrÃ©e Ã  domicile" style="-fx-padding:0 0 0 25; -fx-text-fill:#475569;"/>
                            <Label text="âœ“ Paiement partout" style="-fx-padding:0 0 0 25; -fx-text-fill:#475569;"/>
                        </VBox>

                        <VBox spacing="5" style="-fx-background-color:#f8fafc; -fx-padding:12; -fx-background-radius:10;">
                            <RadioButton fx:id="premiumRadio" text="PREMIUM - 50 TND/an"
                                         style="-fx-font-weight:bold; -fx-text-fill:#1e293b;"/>
                            <Label text="âœ“ Carte mÃ©tal" style="-fx-padding:0 0 0 25; -fx-text-fill:#475569;"/>
                            <Label text="âœ“ Assurance voyage" style="-fx-padding:0 0 0 25; -fx-text-fill:#475569;"/>
                        </VBox>

                        <VBox spacing="5" style="-fx-background-color:#f8fafc; -fx-padding:12; -fx-background-radius:10;">
                            <RadioButton fx:id="entrepriseRadio" text="ENTREPRISE - 20 TND/mois"
                                         style="-fx-font-weight:bold; -fx-text-fill:#1e293b;"/>
                            <Label text="âœ“ Pour professionnels" style="-fx-padding:0 0 0 25; -fx-text-fill:#475569;"/>
                        </VBox>
                    </VBox>
                </ScrollPane>

                <HBox spacing="15" alignment="CENTER_RIGHT">
                    <Button text="â† Retour" onAction="#allerEtape3"
                            style="-fx-background-color:#64748b; -fx-text-fill:white; -fx-font-weight:bold;
                                   -fx-background-radius:25; -fx-cursor:hand; -fx-padding:10 20; -fx-font-size:14px;"/>
                    <Button text="Ã‰tape suivante â†’" onAction="#allerEtape5"
                            style="-fx-background-color:#4f46e5; -fx-text-fill:white; -fx-font-weight:bold;
                                   -fx-background-radius:25; -fx-cursor:hand; -fx-padding:12 30; -fx-font-size:14px;
                                   -fx-effect:dropshadow(two-pass-box, rgba(79,70,229,0.3), 8,0,0,2);"/>
                </HBox>
            </VBox>

            <!-- ================= Ã‰TAPE 5 : PERSONNALISATION ================= -->
            <VBox fx:id="etape5" spacing="20" visible="false" managed="false">

                <Label text="ðŸŽ¨ Ã‰TAPE 5 : PERSONNALISEZ VOTRE CARTE"
                       style="-fx-font-size:18px; -fx-font-weight:bold; -fx-text-fill:#4f46e5;"/>

                <VBox spacing="5">
                    <Label text="Nom Ã  graver :" style="-fx-font-weight:600; -fx-text-fill:#374151;"/>
                    <TextField fx:id="nomCarteField" promptText="JEAN DUPONT"
                               style="-fx-background-color: white; -fx-border-color: #d1d5db; -fx-border-radius: 10; -fx-background-radius: 10; -fx-padding: 10 15;"/>
                </VBox>

                <VBox spacing="8">
                    <Label text="Couleur :" style="-fx-font-weight:600; -fx-text-fill:#374151;"/>
                    <HBox spacing="15" alignment="CENTER_LEFT">
                        <RadioButton fx:id="couleurNoir" text="Noir"/>
                        <RadioButton fx:id="couleurBlanc" text="Blanc"/>
                        <RadioButton fx:id="couleurBleu" text="Bleu"/>
                        <RadioButton fx:id="couleurRouge" text="Rouge"/>
                        <RadioButton fx:id="couleurOr" text="Or"/>
                    </HBox>
                </VBox>

                <VBox spacing="8">
                    <Label text="Options :" style="-fx-font-weight:600; -fx-text-fill:#374151;"/>
                    <CheckBox fx:id="sansContact" text="Paiement sans contact" selected="true"/>
                    <CheckBox fx:id="etranger" text="Paiement Ã  l'Ã©tranger" selected="true"/>
                    <CheckBox fx:id="retrait" text="Retrait distributeur" selected="true"/>
                    <CheckBox fx:id="decouvert" text="DÃ©couvert autorisÃ© (100 TND max)"/>
                </VBox>

                <VBox spacing="8">
                    <Label text="Plafond journalier :" style="-fx-font-weight:600; -fx-text-fill:#374151;"/>
                    <HBox spacing="15" alignment="CENTER_LEFT">
                        <Slider fx:id="plafondSlider" min="100" max="3000" value="500"
                                prefWidth="350" showTickLabels="true" showTickMarks="true"
                                majorTickUnit="500" minorTickCount="4"/>
                        <Label fx:id="plafondValue" text="500 TND"
                               style="-fx-font-weight:bold; -fx-text-fill:#4f46e5; -fx-font-size:16px;"/>
                    </HBox>
                </VBox>

                <HBox spacing="15" alignment="CENTER_RIGHT">
                    <Button text="â† Retour" onAction="#allerEtape4"
                            style="-fx-background-color:#64748b; -fx-text-fill:white; -fx-font-weight:bold;
                                   -fx-background-radius:25; -fx-cursor:hand; -fx-padding:10 20; -fx-font-size:14px;"/>
                    <Button text="Ã‰tape suivante â†’" onAction="#allerEtape6"
                            style="-fx-background-color:#4f46e5; -fx-text-fill:white; -fx-font-weight:bold;
                                   -fx-background-radius:25; -fx-cursor:hand; -fx-padding:12 30; -fx-font-size:14px;
                                   -fx-effect:dropshadow(two-pass-box, rgba(79,70,229,0.3), 8,0,0,2);"/>
                </HBox>
            </VBox>

            <!-- ================= Ã‰TAPE 6 : PREMIER DÃ‰PÃ”T ================= -->
            <VBox fx:id="etape6" spacing="20" visible="false" managed="false">

                <Label text="ðŸ’° Ã‰TAPE 6 : PREMIER DÃ‰PÃ”T"
                       style="-fx-font-size:18px; -fx-font-weight:bold; -fx-text-fill:#4f46e5;"/>

                <GridPane hgap="15" vgap="12">
                    <columnConstraints>
                        <ColumnConstraints percentWidth="30"/>
                        <ColumnConstraints percentWidth="70"/>
                    </columnConstraints>

                    <Label text="Montant :" GridPane.rowIndex="0" GridPane.columnIndex="0"
                           style="-fx-font-weight:600; -fx-text-fill:#374151;"/>
                    <TextField fx:id="montantField" promptText="50"
                               GridPane.rowIndex="0" GridPane.columnIndex="1"
                               style="-fx-background-color: white; -fx-border-color: #d1d5db; -fx-border-radius: 10; -fx-background-radius: 10; -fx-padding: 10 15;"/>

                    <Label text="Mode :" GridPane.rowIndex="1" GridPane.columnIndex="0"
                           style="-fx-font-weight:600; -fx-text-fill:#374151;"/>
                    <ComboBox fx:id="paiementCombo" promptText="Mode de paiement"
                              GridPane.rowIndex="1" GridPane.columnIndex="1"
                              style="-fx-background-color: white; -fx-border-color: #d1d5db; -fx-border-radius: 10; -fx-background-radius: 10; -fx-pref-height: 40;"/>

                    <Label text="Devise :" GridPane.rowIndex="2" GridPane.columnIndex="0"
                           style="-fx-font-weight:600; -fx-text-fill:#374151;"/>
                    <ComboBox fx:id="deviseCombo" promptText="TND"
                              GridPane.rowIndex="2" GridPane.columnIndex="1"
                              style="-fx-background-color: white; -fx-border-color: #d1d5db; -fx-border-radius: 10; -fx-background-radius: 10; -fx-pref-height: 40;"/>
                </GridPane>

                <Label fx:id="infoMinimumLabel"
                       text="ðŸ’° Montant minimum requis : 10 TND (standard) / 20 TND (carte virtuelle) / 50 TND (carte physique)"
                       style="-fx-text-fill:#64748b; -fx-font-size:13px; -fx-padding:5 0 0 0;" wrapText="true"/>

                <HBox spacing="15" alignment="CENTER_RIGHT">
                    <Button text="â† Retour" onAction="#allerEtape5"
                            style="-fx-background-color:#64748b; -fx-text-fill:white; -fx-font-weight:bold;
                                   -fx-background-radius:25; -fx-cursor:hand; -fx-padding:10 20; -fx-font-size:14px;"/>
                    <Button text="Ã‰tape suivante â†’" onAction="#allerEtape7"
                            style="-fx-background-color:#4f46e5; -fx-text-fill:white; -fx-font-weight:bold;
                                   -fx-background-radius:25; -fx-cursor:hand; -fx-padding:12 30; -fx-font-size:14px;
                                   -fx-effect:dropshadow(two-pass-box, rgba(79,70,229,0.3), 8,0,0,2);"/>
                </HBox>
            </VBox>

            <!-- ================= Ã‰TAPE 7 : RÃ‰CAPITULATIF ================= -->
            <VBox fx:id="etape7" spacing="20" visible="false" managed="false">

                <Label text="âœ… Ã‰TAPE 7 : RÃ‰CAPITULATIF"
                       style="-fx-font-size:18px; -fx-font-weight:bold; -fx-text-fill:#4f46e5;"/>

                <VBox spacing="10" style="-fx-background-color:#f8fafc; -fx-padding:20; -fx-background-radius:15; -fx-border-color:#e5e7eb; -fx-border-radius:15; -fx-border-width:1;">
                    <Label text="VOS INFORMATIONS" style="-fx-font-weight:bold; -fx-text-fill:#4f46e5; -fx-font-size:14px;"/>
                    <Label fx:id="recapNom" text="Nom: -" style="-fx-text-fill:#475569;"/>
                    <Label fx:id="recapEmail" text="Email: -" style="-fx-text-fill:#475569;"/>

                    <Separator/>

                    <Label text="FORMULE CHOISIE" style="-fx-font-weight:bold; -fx-text-fill:#4f46e5; -fx-font-size:14px;"/>
                    <Label fx:id="recapFormule" text="Formule: -" style="-fx-text-fill:#475569;"/>
                    <Label fx:id="recapCarte" text="Carte: -" style="-fx-text-fill:#475569;"/>

                    <Separator/>

                    <Label text="PREMIER DÃ‰PÃ”T" style="-fx-font-weight:bold; -fx-text-fill:#4f46e5; -fx-font-size:14px;"/>
                    <Label fx:id="recapMontant" text="Montant: -" style="-fx-text-fill:#475569; -fx-font-weight:bold;"/>
                </VBox>

                <VBox spacing="8">
                    <CheckBox fx:id="acceptCGU" text="J'accepte les Conditions GÃ©nÃ©rales d'Utilisation"
                              style="-fx-text-fill:#374151; -fx-font-size:14px;"/>
                    <CheckBox fx:id="acceptInfos" text="Je certifie l'exactitude des informations fournies"
                              style="-fx-text-fill:#374151; -fx-font-size:14px;"/>
                </VBox>

                <Button text="âœ… VALIDER MON WALLET" onAction="#validerInscription"
                        style="-fx-background-color:#22c55e; -fx-text-fill:white; -fx-font-weight:bold;
                               -fx-background-radius:25; -fx-cursor:hand; -fx-padding:15 0; -fx-font-size:16px;
                               -fx-effect:dropshadow(two-pass-box, rgba(34,197,94,0.3), 10,0,0,3);"
                        maxWidth="Infinity"/>

                <HBox spacing="15" alignment="CENTER_RIGHT">
                    <Button text="â† Retour" onAction="#allerEtape6"
                            style="-fx-background-color:#64748b; -fx-text-fill:white; -fx-font-weight:bold;
                                   -fx-background-radius:25; -fx-cursor:hand; -fx-padding:10 20; -fx-font-size:14px;"/>
                </HBox>
            </VBox>

        </VBox>

        <!-- Footer -->
        <Label text="Â© 2026 SmartWallet - SÃ©curisÃ© et fiable"
               style="-fx-text-fill:#94a3b8; -fx-font-size:12px;"/>
    </VBox>

</StackPane>