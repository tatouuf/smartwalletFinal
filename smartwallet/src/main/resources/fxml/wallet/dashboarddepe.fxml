<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.scene.chart.*?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>

<BorderPane fx:id="rootPane"
            xmlns="http://javafx.com/javafx"
            xmlns:fx="http://javafx.com/fxml"
            fx:controller="esprit.tn.chayma.controllers.DashboardDepensController"
            prefWidth="1450" prefHeight="920"
            style="-fx-background-color: #FDF2F8;">

    <!-- ================= HEADER ================= -->
    <top>
        <HBox alignment="CENTER_LEFT"
              style="-fx-background-color: linear-gradient(to right, #EC4899, #F472B6);
                     -fx-padding: 22 40;
                     -fx-effect: dropshadow(gaussian, rgba(236,72,153,0.4), 25, 0.3, 0, 6);">

            <Label text="ðŸ’Ž Fintech Dashboard"
                   style="-fx-text-fill: white;
                          -fx-font-size: 28px;
                          -fx-font-weight: bold;"/>
        </HBox>
    </top>

    <!-- ================= SIDEBAR ================= -->
    <left>
        <VBox spacing="18"
              prefWidth="250"
              style="-fx-background-color: #1F0A1A;
                     -fx-padding: 40 20;">

            <Label text="NAVIGATION"
                   style="-fx-text-fill: #F9A8D4;
                          -fx-font-size: 12px;
                          -fx-font-weight: bold;"/>

            <!-- DASHBOARD ACTIVE -->
            <Button text="ðŸ  Dashboard"
                    maxWidth="Infinity"
                    style="-fx-background-color: #EC4899;
                           -fx-text-fill: white;
                           -fx-font-size: 15px;
                           -fx-background-radius: 12;
                           -fx-padding: 12 15;
                           -fx-font-weight: bold;
                           -fx-effect: dropshadow(gaussian, rgba(236,72,153,0.6), 15, 0.3, 0, 4);"/>

            <Button fx:id="depensesButton" text="ðŸ’° DÃ©penses" onAction="#handleDepenses"
                    maxWidth="Infinity"
                    style="-fx-background-color: transparent;
                           -fx-text-fill: #FBCFE8;
                           -fx-font-size: 15px;
                           -fx-background-radius: 12;
                           -fx-padding: 12 15;"/>

            <Button text="ðŸ“Š Budgets"
                    onAction="#handleBudgets"
                    maxWidth="Infinity"
                    style="-fx-background-color: transparent;
                           -fx-text-fill: #FBCFE8;
                           -fx-font-size: 15px;
                           -fx-background-radius: 12;
                           -fx-padding: 12 15;"/>
            <Button text="ðŸ“Š Plannings"
                    onAction="#handlePlannings"
                    maxWidth="Infinity"
                    style="-fx-background-color: transparent;
                           -fx-text-fill: #FBCFE8;
                           -fx-font-size: 15px;
                           -fx-background-radius: 12;
                           -fx-padding: 12 15;"/>
                <Button text="âš™ï¸ Settings"
                    onAction="#handleSettings"
                    maxWidth="Infinity"
                    style="-fx-background-color: transparent;
                           -fx-text-fill: #FBCFE8;
                           -fx-font-size: 15px;
                           -fx-background-radius: 12;
                           -fx-padding: 12 15;"/>
                <Button text="ðŸ”” Notifications"
                    onAction="#handleNotifications"
                    maxWidth="Infinity"
                    style="-fx-background-color: transparent;
                           -fx-text-fill: #FBCFE8;
                           -fx-font-size: 15px;
                           -fx-background-radius: 12;
                           -fx-padding: 12 15;"/>
                <Region VBox.vgrow="ALWAYS"/>

            <Button text="ðŸ”’ Logout"
                    onAction="#handleLogout"
                    maxWidth="Infinity"
                    style="-fx-background-color: #F44336;
                           -fx-text-fill: white;
                           -fx-font-size: 15px;
                           -fx-background-radius: 12;
                           -fx-padding: 12 15;"/>
            <Button text="Advisor"
                    onAction="#handleAdvisor"
                    maxWidth="Infinity"
                    style="-fx-background-color: #6A1B9A;
               -fx-text-fill: white;
               -fx-font-size: 15px;
               -fx-background-radius: 12;
               -fx-padding: 12 15;"/>

        </VBox>
    </left>

    <!-- ================= CENTER ================= -->
    <center>
        <ScrollPane fitToWidth="true" fitToHeight="true">
            <VBox spacing="20" style="-fx-padding: 20;">
                <!-- Navigation Buttons -->

                <!-- Cartes de statistiques -->
                <HBox spacing="20">
                    <!-- Total DÃ©penses -->
                    <VBox style="-fx-border-color: #2196F3; -fx-border-radius: 5; -fx-padding: 20; -fx-background-color: #E3F2FD;" HBox.hgrow="ALWAYS">
                        <Label text="Total des DÃ©penses" style="-fx-font-size: 14; -fx-font-weight: bold; -fx-text-fill: #1976D2;"/>
                        <Label fx:id="totalDepensesLabel" text="0.00 DT" style="-fx-font-size: 20; -fx-font-weight: bold; -fx-text-fill: #1565C0;"/>
                    </VBox>

                    <!-- DÃ©penses Mois -->
                    <VBox style="-fx-border-color: #4CAF50; -fx-border-radius: 5; -fx-padding: 20; -fx-background-color: #E8F5E9;" HBox.hgrow="ALWAYS">
                        <Label text="DÃ©penses ce Mois" style="-fx-font-size: 14; -fx-font-weight: bold; -fx-text-fill: #388E3C;"/>
                        <Label fx:id="depensesMoisLabel" text="0.00 DT" style="-fx-font-size: 20; -fx-font-weight: bold; -fx-text-fill: #2E7D32;"/>
                    </VBox>

                    <!-- Total Budgets -->
                    <VBox style="-fx-border-color: #FF9800; -fx-border-radius: 5; -fx-padding: 20; -fx-background-color: #FFF3E0;" HBox.hgrow="ALWAYS">
                        <Label text="Total des Budgets" style="-fx-font-size: 14; -fx-font-weight: bold; -fx-text-fill: #E65100;"/>
                        <Label fx:id="totalBudgetsLabel" text="0.00 DT" style="-fx-font-size: 20; -fx-font-weight: bold; -fx-text-fill: #D84315;"/>
                    </VBox>

                    <!-- Total Plannings -->
                    <VBox style="-fx-border-color: #9C27B0; -fx-border-radius: 5; -fx-padding: 20; -fx-background-color: #F3E5F5;" HBox.hgrow="ALWAYS">
                        <Label text="Nombre de Plannings" style="-fx-font-size: 14; -fx-font-weight: bold; -fx-text-fill: #7B1FA2;"/>
                        <Label fx:id="totalPlanningsLabel" text="0" style="-fx-font-size: 20; -fx-font-weight: bold; -fx-text-fill: #6A1B9A;"/>
                    </VBox>

                    <!-- Budget UtilisÃ© -->
                    <VBox style="-fx-border-color: #F44336; -fx-border-radius: 5; -fx-padding: 20; -fx-background-color: #FFEBEE;" HBox.hgrow="ALWAYS">
                        <Label text="Budget UtilisÃ©" style="-fx-font-size: 14; -fx-font-weight: bold; -fx-text-fill: #C62828;"/>
                        <Label fx:id="budgetUtiliseLabel" text="0.00 DT" style="-fx-font-size: 20; -fx-font-weight: bold; -fx-text-fill: #B71C1C;"/>
                    </VBox>

                    <!-- PrÃ©diction DÃ©penses Mois Prochain -->
                    <VBox style="-fx-border-color: #00BCD4; -fx-border-radius: 5; -fx-padding: 20; -fx-background-color: #E0F7FA;" HBox.hgrow="ALWAYS">
                        <Label text="PrÃ©diction Mois Prochain" style="-fx-font-size: 14; -fx-font-weight: bold; -fx-text-fill: #00838F;"/>
                        <Label fx:id="predictionDepensesLabel" text="0.00 DT" style="-fx-font-size: 20; -fx-font-weight: bold; -fx-text-fill: #006064;"/>
                    </VBox>
                </HBox>

                <!-- Graphiques -->
                <HBox spacing="20" prefHeight="400">
                    <!-- Pie Chart -->
                    <TitledPane text="DÃ©penses par CatÃ©gorie" prefWidth="350" prefHeight="400" animated="false">
                        <PieChart fx:id="depensesCategorieChart" prefHeight="360"/>
                    </TitledPane>

                    <!-- Bar Chart -->
                    <TitledPane text="DÃ©penses par Mois" animated="false" HBox.hgrow="ALWAYS">
                        <BarChart fx:id="depensesParMoisChart" categoryGap="10" barGap="5" prefHeight="360">
                            <xAxis>
                                <CategoryAxis label="Mois"/>
                            </xAxis>
                            <yAxis>
                                <NumberAxis label="Montant (DT)"/>
                            </yAxis>
                        </BarChart>
                    </TitledPane>
                </HBox>

                <!-- Line Chart -->
                <TitledPane text="Ã‰volution des DÃ©penses" animated="false" prefHeight="400">
                    <LineChart fx:id="evolutionDepensesChart" prefHeight="360">
                        <xAxis>
                            <CategoryAxis label="Date"/>
                        </xAxis>
                        <yAxis>
                            <NumberAxis label="Montant (DT)"/>
                        </yAxis>
                    </LineChart>
                </TitledPane>
            </VBox>
        </ScrollPane>
    </center>

</BorderPane>